FROM xshop:clang38
#FROM xshop:base_test_image

#
# Installation
#

WORKDIR /home/

#{% if install_type=="debian" %}
#    ADD {{ library }}-{{ version }} /home/

#    RUN dpkg -i {{ library }}_{{ version }}-1_amd64.deb
#    RUN apt-get -y install -f

#{% elif install_type=="source" %}
	ADD {{ library }}-{{ version }}.tar.gz /home/
	WORKDIR /home/jpeg-{{ version }}
    RUN ./configure --prefix=/usr
    RUN make -j16 CC=clang CXX=clang++ CFLAGS+={{ cflag }} LDFLAGS+={{ cflag }}
	RUN make test
	RUN mkdir /usr/man
	RUN mkdir /usr/man/man1
	RUN make install
	{% if version=="6b" %}
		RUN make install-lib
		RUN make install-headers
	{% else %}
	    RUN make install-includeHEADERS
		RUN make install-data-local
	{% endif %}
#{% else %}
#    RUN apt-get -y install libjpeg-dev

#{% endif %}

#
#   Add any configuration for the software
#
