from subprocess import call as sh
import time
import exploit
def run(run_function):
	run_function('target','start_server')
	time.sleep(1)
	run_function('attacker','run_exploit')
	time.sleep(1)
        run_function('target','check')


def start_server():
	sh(['proftpd'])
	sh(['rsyslogd'])
	sh(['ps','aux'])

def run_exploit():
	exploit.run()
        return 0

def check():
        print "Checking Syslog"
        log = open('/var/log/syslog')
        data = log.read()
        print data
        if 'signal 11' in data:
            print "Success!"
            return 2
        else:
            print "Failure"
            return 0
