#
# Define the code which runs inside the test containers. 
#
# Use the run() function to list which hooks should run in which containers
# and in what order. Simply call H.run() as many times as needed. 
#
# Hooks can be any function in this file. 
#

from subprocess import call as sh
import time
def run(H):
	H.run('target','start_samba')
	time.sleep(1)
	H.run('attacker','run_exploit')


def start_samba():
	sh(['/usr/local/samba/sbin/nmbd','-D'])
	sh(['/usr/local/samba/sbin/smbd','-D'])
	sh(['ps','aux'])

def run_exploit():
	sh(['smbclient','-L','//target'])
	sh(['python','exploit.py','target','139','localhost','22','01'])
	return 0
