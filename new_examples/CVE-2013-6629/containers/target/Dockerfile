FROM_DOCKER xshop:clang38

{% if install_type=="source" %}
	#
	#	For installation from source, we first install 
	# 	dependencies mentioned in config.yaml
	#
	{% for d in builddeps %}
		RUN apt-get -y install {{ d }}
	{% endfor %}

	#
	# 	Next, we run a standard autotools installation
	#
	ADD {{ library }}-{{ version }}.tar.gz ~/
	WORKDIR ~/jpeg-{{ version }}
	RUN ls ~	
	RUN ./configure --prefix=/usr
    	RUN make -j16 CC=clang CXX=clang++ CFLAGS+={{ cflag }} LDFLAGS+={{ cflag }}
	RUN make test
	RUN mkdir /usr/man
	RUN mkdir /usr/man/man1
    	RUN make install

	{% if version=="6b" %}
		RUN make install-lib
		RUN make install-headers
	{% else %}
		RUN make install-includeHEADERS
		RUN make install-data-local
	{% endif %}
{% endif %}
